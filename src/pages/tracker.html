<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Santa Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f0f8ff; /* Light Blue */
        }
        .container {
            text-align: center;
            padding: 20px;
        }
        #currentLocation {
            font-size: 24px;
            font-weight: bold;
            margin-top: 50px;
        }
        #map {
            position: relative;
            width: 80%;
            height: 400px;
            margin: 20px auto;
            overflow: hidden; /* Hide overflow to prevent image from overflowing */
        }
        #santa {
            position: absolute;
            transition: top 1s, left 1s; /* Smooth transition for Santa's movement */
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="currentLocation">Loading...</div>
        <div id="map">
            <img id="santa" src="santa.png" width="50" height="50"> <!-- Image of Santa -->
            <img src="https://cdn.glitch.global/00096ffa-1c6f-46f0-aa52-09cd4de366d6/satellite-map-of-the-world_wm00875.jpg?v=1707770779809" width="100%" height="100%">
        </div>
    </div>

    <script>
        async function getCurrentCoordinates() {
            const response = await fetch('/getcurrentcoordinates');
            const data = await response.json();
            return data;
        }

        async function updateSantaPosition() {
            const coordinates = await getCurrentCoordinates();
            const santa = document.getElementById('santa');
            const map = document.getElementById('map');
            const mapWidth = map.offsetWidth; // Width of the map container
            const mapHeight = map.offsetHeight; // Height of the map container
            const santaWidth = santa.offsetWidth; // Width of the Santa image
            const santaHeight = santa.offsetHeight; // Height of the Santa image
            const left = (coordinates.longitude / 360 + 0.5) * mapWidth - santaWidth / 2; // Calculate left position
            const top = (0.5 - coordinates.latitude / 180) * mapHeight - santaHeight / 2; // Calculate top position
            santa.style.left = `${left}px`; // Set left position
            santa.style.top = `${top}px`; // Set top position
        }

        async function displayCurrentLocation() {
            const currentLocationDiv = document.getElementById('currentLocation');
            const coordinates = await getCurrentCoordinates();
            currentLocationDiv.innerText = `Santa's Current Coordinates: Latitude ${coordinates.latitude}, Longitude ${coordinates.longitude}`;
            updateSantaPosition(); // Update Santa's position
        }

        window.onload = () => {
            // Display the current location immediately
            displayCurrentLocation();

            // Update the current location every second
            setInterval(displayCurrentLocation, 1000);
        };
    </script>
</body>
</html>
